<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Python to Google Sheets</title>

    <!-- Bootstrap Core CSS -->
    <link href="http://erood.github.io/css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="http://erood.github.io/css/blog-post.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav id="navbar-inverse"class="navbar navbar-inverse navbar-fixed-top" role="navigation">

      <!--change background colors on page reload-->
      <script>
      var colors = ['#0078FF', '#077596', 'rgb(50, 218, 113)', 'rgba(12, 26, 154, 0.86)', '#17bf63', '#2196F3', '#607D8B', '#0D47A1', '#ffad1f' ];

      var changeBackground = function() {
        document.getElementById("navbar-inverse").style.background = colors[Math.floor(Math.random()*colors.length)];
      };
      changeBackground();
      </script>
      <!--end change background colors on page reload-->

        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://erikrood.com">Erik Rood</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="http://erikrood.com/about.html">About</a>
                    </li>
                    <li>
                        <a href="http://erikrood.com/contact.html">Contact</a>
                    </li>

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">

        <div class="row">

            <!-- Blog Post Content Column -->
            <div class="col-lg-10">
            <!--normally use ~8, using wider to match iframe-->
                <!-- Blog Post -->

                  <p class="lead">Reading and writing to Google Spreadsheets using Python</p>

                  <hr>
                  <p>
                    <b>Google Drive API, credentials</b>
                  </p>
                  <p>In order to follow along, you're going to need a spreadsheet. Head over to <a href="https://docs.google.com/spreadsheets/u/0/">Google Sheets</a>
                    create one. Put a few dummy columns in there so you can programatically access it later.
                </p>
                <p>Next, you'll need to create a service account and OAuth2 credentials from the <a href="https://console.developers.google.com/">Google API Console</a>.
                  Follow the steps below to enable the API and grab your credentials.
              </p>

              <ol>
                <li> Head over to the <a href="https://console.developers.google.com/">Google API Console</a>.</li>
                <li>Create a new project by selecting My Project -> + button</li>
                <li>Search for 'Google Drive API', enable it.</li>
                <li> Head over to 'Credentials' (sidebar), click 'Create Credentials' -> 'Service Account Key'</li>
                <br>
                <img style= max-width:100%; height= auto; src="create_credentials.png" alt="Create credentials">
                <br>
                <li> Select Compute Engine service default, JSON, hit create.</li>
                <li> Open up the JSON file, share your spreadsheet with the "XXX-compute@developer.gserviceaccount.com" email listed.</li>
                <li> Save the JSON file wherever you're hosting your project, you'll need to load it in through Python later.</li>
              </ol>

                <p>
                  <b>Connecting Python to Google Sheets</b>
                </p>
                <p>
                  First, you'll need to install <a href="https://github.com/nithinmurali/pygsheets">pygsheets</a>, which allows us to actually read/write to the sheet through Python.
                  Once that's installed, you're all set. Here's an example of importing the credentials and writing some dummy data to the sheet using a Pandas dataframe:
                </p>

                <!--begin python dump-->
                <link rel="stylesheet" href="http://erikrood.com/Python_References/notebooks.css">
                <!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#authorization</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">service_file</span><span class="o">=</span><span class="s1">&#39;/Users/erikrood/desktop/QS_Model/creds.json&#39;</span><span class="p">)</span>

<span class="c1"># Create empty dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Create a column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Steve&#39;</span><span class="p">,</span> <span class="s1">&#39;Sarah&#39;</span><span class="p">]</span>

<span class="c1">#open the google spreadsheet (where &#39;PY to Gsheet Test&#39; is the name of my sheet)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;PY to Gsheet Test&#39;</span><span class="p">)</span>

<span class="c1">#select the first sheet </span>
<span class="n">wks</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#update the first sheet with df, starting at cell B2. </span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>



</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
    <div class="input_area">


</div>
</div>
</div>

</div>
    </div>
  </div>
</body>

<!--end python dump-->



        <br>
        <!-- /.row -->
        <!-- Begin MailChimp Signup Form -->

        <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:##0078FF; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//datadriventhoughts.us13.list-manage.com/subscribe/post?u=262c11ce96e8bc9ddb6d07ea8&amp;id=e37c601527" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Enter your email to be notified when I write something ~1x/month
</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_262c11ce96e8bc9ddb6d07ea8_e37c601527" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
        <hr>
        <div class="container">
        <footer>
            <div class="row">
                <div class="col-lg-10">
                    <p>Copyright &copy; Erik Rood 2017</p>
                </div>
            </div>
            <!-- /.row -->
        </footer>
      </div>
        <!-- Footer -->


    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.js"></script>
    <!--Google analytics-->
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89151121-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
